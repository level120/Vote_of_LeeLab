{% extends "VoteApp/layout.html" %}
{% load mathfilters %}
{% block content %}
<section id="vote" class="container content">
    <div style="margin-bottom: 20px;"></div>
    <div class="col-md-3"></div>
    <div class="col-md-6">
        <div class="call-action call-action-boxed call-action-style1 clearfix">
            <h2 style="text-align:center;" class="primary">{{ date_of_begin_time }}</h2>
        </div>
        
        <div class="alert alert-success" role="alert">
            <h4 style="text-align:center;" class="alert-heading">남은 시간 : <span style="margin-left:15px" id="day">0</span>일<span style="margin-left:15px" id="hour">0</span>시<span style="margin-left:15px" id="min">0</span>분<span style="margin-left:15px" id="sec">0</span>초</h4>
        </div>
    </div>
    <div class="col-md-3"></div>
    <div class="row">
        <div class="col-md-12">
            <div style="margin-bottom: 20px;"></div>

            <ul class="nav nav-pills">
                <li><a href="{% url 'vote' %}" style="color:black">투표하기</a></li>
                <li class="active"><a href="{% url 'result' %}">결과보기</a></li>
            </ul>
        </div>
        <div style="margin-bottom: 20px;"></div>
        <div class="col-md-12">
            <div class="table-responsive">
                <table style="font-size: 13px" class="table table-striped table-bordered sortable-table clickable-table" id="problemset">
                    <thead>
                        <tr>
                            <th style="text-align:center;width:6%" data-sort="int">No.</th>
                            <th style="text-align:center;width:12%" data-sort="string">이름</th>
                            <th style="text-align:center;width:40%" data-sort="string">설명</th>
                            <th style="text-align:center;width:35%">득표현황</th>
                            <th style="text-align:center;width:8%">투표여부</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for player in players %}
                        <tr>
                            <td style="vertical-align:middle; text-align:center">{{ player.id }}</td>
                            <td style="vertical-align:middle; text-align:center"><span class = 'user-green'>{{ player.name }}</span></td>
                            <td style="vertical-align:middle" class="click-this">{{ player.description }}</td>
                            <td style="vertical-align:middle;width:35%">
                                <div class="progress progress-striped active" style="margin-bottom: 0px;">
                                    {% with percent=100 %}
                                    <div class="progress-bar " style="width: {{ player.total_likes|div:all_member|mul:percent }}%;"><span style="vertical-align:middle">{{ player.total_likes }} / {{ all_member }}</span></div>
                                    {#<div class="progress-bar progress-bar-success" style="width: 100%;">1</div>#}
                                    {% endwith %}
                                </div>
                            </td>
                            {% if user.is_authenticated %}
                            <td style="vertical-align:middle"><button type="button" id="{{ player.id }}" class="like glyphicon glyphicon-thumbs-up {{ result }}"> 결과보기</button></td>
                            {% endif %}
                        </tr>
                        {% endfor %}
                    </tbody>

                </table>
            </div>
        </div>
    </div>

    <div style="margin-bottom: 20px;"></div>

</section>

<script type="text/javascript">
    $(document).ready(function () {
        var dday = {{ server_time }};
        if (dday > 0) {
            var timer = setInterval(function () {
                if (dday == 0) {
                    notify();
                    location.reload();
                } else {
                    var rest = --dday;
                    var sec = rest % 60;
                    var min = ((rest - sec) / 60) % 60;
                    var hours = ((((rest - sec) / 60) - min) / 60) % 24;
                    var days = ((((((rest - sec) / 60) - min) / 60) - hours) / 24);

                    $("#sec").html((sec < 10) ? ('0' + sec) : sec);
                    $("#min").html((min < 10) ? ('0' + min) : min);
                    $("#hour").html((hours < 10) ? ('0' + hours) : hours);
                    $("#day").html((days < 10) ? ('0' + days) : days);
                }
            }, 1000);
        }
        else {
            clearInterval(timer);
        }
    });

</script >
{% endblock %}